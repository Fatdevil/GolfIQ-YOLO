services:
  app:
    image: ghcr.io/${GH_USER:-fatdevil}/golfiq-yolo:staging
    build:
      context: .
      args:
        VIDEO_EXTRAS: "0"
    env_file:
      - server/.env.staging
    environment:
      APP_ENV: "staging"
      STAGING: "1"
      SERVE_WEB: "0"
      GOLFIQ_RUNS_DIR: "/data/runs"
      RUNS_UPLOAD_DIR: "/data/uploads"
      GOLFIQ_ROUNDS_DIR: "/data/rounds"
      GOLFIQ_BAGS_DIR: "/data/bags"
      FEATURE_FLAGS_CONFIG_PATH: "/data/config/feature_flags.json"
    ports:
      - "8000:8000"
    volumes:
      - ./data/runs:/data/runs
      - ./data/uploads:/data/uploads
      - ./data/rounds:/data/rounds
      - ./data/bags:/data/bags
      - ./data/config:/data/config
